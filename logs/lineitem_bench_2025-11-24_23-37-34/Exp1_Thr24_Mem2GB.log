warning[E0133]: call to unsafe function `libc::posix_fadvise` is unsafe and requires unsafe block
   --> src/kvbin.rs:267:19
    |
267 |         let ret = libc::posix_fadvise(fd, 0, 0, libc::POSIX_FADV_DONTNEED);
    |                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ call to unsafe function
    |
    = note: for more information, see <https://doc.rust-lang.org/nightly/edition-guide/rust-2024/unsafe-op-in-unsafe-fn.html>
    = note: consult the function's documentation for information on how to avoid undefined behavior
note: an unsafe function restricts its caller, but its body is safe by default
   --> src/kvbin.rs:263:1
    |
263 | unsafe fn drop_cache(fd: i32) {
    | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    = note: `#[warn(unsafe_op_in_unsafe_fn)]` on by default

For more information about this error, try `rustc --explain E0133`.
warning: `es` (lib) generated 1 warning (run `cargo fix --lib -p es` to apply 1 suggestion)
    Finished `release` profile [optimized] target(s) in 2.26s
     Running `target/release/examples/lineitem_benchmark_cli -n Exp1_Thr24_Mem2GB -i /tank/local/riki/lineitem_sf500.csv --run-gen-threads 24 --merge-threads 24 --run-size-mb 85.33 --merge-fanin 1365 --warmup-runs 0 --benchmark-runs 1 --cooldown-seconds 30 --dir logs/lineitem_bench_2025-11-24_23-37-34/Exp1_Thr24_Mem2GB_tmp --ovc`
Using existing KVBin file: "./datasets/lineitem_sf500.k-8-9-13-14-15.v-0-3.kvbin"

=== BENCHMARK MODE ===
KVBin data: ./datasets/lineitem_sf500.k-8-9-13-14-15.v-0-3.kvbin, index: ./datasets/lineitem_sf500.k-8-9-13-14-15.v-0-3.kvbin.idx
Estimated data size: 199659.46 MB
Run generation threads: 24
Run generation algorithm: replacement-selection
Run size (MB): 85.33
Run generation memory (MB): 2047.9
Merge threads: 24
Merge fan-in: 1365
Merge memory (MB): 2047.5
OVC enabled: true
Temporary directory: "logs/lineitem_bench_2025-11-24_23-37-34/Exp1_Thr24_Mem2GB_tmp"
Warmup runs: 0
Runs per configuration: 1
Cooldown between runs (s): 30
Verify output: false

Running benchmark for config: Exp1_Thr24_Mem2GB
Parameters: Run Gen Threads: 24, Run Gen Algorithm: replacement-selection, Run Size: 85.33 MB, Run Gen Memory: 2047.9 MB, Merge Threads: 24, Merge Fanin: 1365, Merge Memory: 2047.5 MB, Imbalance Factor: 1.0
================================================================================
  Run 1/1: Starting sort with 24 parallel scanners for run generation
Run gen thread 9 (ReplacementSelection) 673852 ms, 50 runs generated
Run gen thread 16 (ReplacementSelection) 673860 ms, 50 runs generated
Run gen thread 21 (ReplacementSelection) 674064 ms, 50 runs generated
Run gen thread 23 (ReplacementSelection) 674587 ms, 50 runs generated
Run gen thread 12 (ReplacementSelection) 675241 ms, 50 runs generated
Run gen thread 10 (ReplacementSelection) 675881 ms, 50 runs generated
Run gen thread 4 (ReplacementSelection) 676340 ms, 50 runs generated
Run gen thread 1 (ReplacementSelection) 678238 ms, 50 runs generated
Run gen thread 22 (ReplacementSelection) 678927 ms, 50 runs generated
Run gen thread 19 (ReplacementSelection) 679497 ms, 50 runs generated
Run gen thread 6 (ReplacementSelection) 680224 ms, 50 runs generated
Run gen thread 14 (ReplacementSelection) 680791 ms, 50 runs generated
Run gen thread 17 (ReplacementSelection) 681050 ms, 50 runs generated
Run gen thread 15 (ReplacementSelection) 681076 ms, 50 runs generated
Run gen thread 7 (ReplacementSelection) 682181 ms, 50 runs generated
Run gen thread 3 (ReplacementSelection) 683042 ms, 50 runs generated
Run gen thread 18 (ReplacementSelection) 684231 ms, 50 runs generated
Run gen thread 0 (ReplacementSelection) 684684 ms, 50 runs generated
Run gen thread 20 (ReplacementSelection) 684710 ms, 50 runs generated
Run gen thread 2 (ReplacementSelection) 685031 ms, 50 runs generated
Run gen thread 13 (ReplacementSelection) 686173 ms, 50 runs generated
Run gen thread 8 (ReplacementSelection) 687388 ms, 50 runs generated
Run gen thread 5 (ReplacementSelection) 689286 ms, 50 runs generated
Run gen thread 11 (ReplacementSelection) 693907 ms, 50 runs generated
Generated 1200 runs in 694606 ms
Merging 1200 runs using 24 threads
Merge phase took 377685 ms | Merged 3000028242 entries across 24 runs | Thread timing: min=330208 ms, max=377682 ms | Partition sizes: imbalance=1.14x
SortStats:
  Number of runs: 1200
  (R) time: 694606 ms
  (R) breakdown: load=0 ms, sort=681010 ms, store=0 ms
  (R) I/O stats: I/O Stats: Read Ops: 3194568, Read Bytes: 209359192421, Write Ops: 2124297, Write Bytes: 139217066496
  (M) time: 377685 ms
  Read amplification:
    Run generation writes: 139217066496 bytes (129.66 GB)
    Merge phase reads: 141750655488 bytes (132.02 GB)
    Read amplification factor: 1.02x
    Excess reads: 1.8% (sparse indexing overhead)
  Thread timing:
    Min thread time: 330208 ms
    Max thread time: 377682 ms
    Avg thread time: 356093 ms
    Time imbalance factor (max/avg): 1.06x
    Thread times: [347526, 344640, 366962, 360307, 367306, 345662, 366819, 330208, 377682, 353166, 377225, 332919, 334554, 371045, 366781, 331300, 370833, 346174, 358158, 357441, 355721, 357539, 358311, 367950]

1072.29s


================================================================================================================================================================
Benchmark Results Summary
================================================================================================================================================================
Config               Run Size   RG Runs    Gen Thr    Merge Thr  Total (s)  RunGen (s)   Merge (s)  Entries      Throughput       Read MB    Write MB  
                     (MB)                                                                                        (M entries/s)                         
----------------------------------------------------------------------------------------------------------------------------------------------------------------
Exp1_Thr24_Mem2GB[1] 85.3       1200       24         24         1072.29      694.61     377.69     3000028242   2.80             334844.4   229535.3  
Exp1_Thr24_Mem2GB[avg] 85.3       1200       24         24         1072.29      694.61     377.69     3000028242   2.80             334844.4   229535.3  
================================================================================================================================================================

================================================================================================================================================================
Merge Operations Summary (showing last 1 of 1 merge passes)
================================================================================================================================================================
Config               M1PAvg     M1PMax     M1Imbal    M1Slow       M1Fast      
----------------------------------------------------------------------------------------------------------------------------------------------------------------
Exp1_Thr24_Mem2GB[1] 125001176  142355693  1.14       377.69       377.69      
----------------------------------------------------------------------------------------------------------------------------------------------------------------
Exp1_Thr24_Mem2GB[avg] 125001176  142355693  1.14       377.69       377.69      
================================================================================================================================================================

================================================================================================================================================================
Detailed I/O Statistics
================================================================================================================================================================
Config               RG Read MB   RG Write MB  M1Read MB    M1Write MB  
----------------------------------------------------------------------------------------------------------------------------------------------------------------
Exp1_Thr24_Mem2GB[1] 199660.5     132767.7     135184.0     96767.6     
----------------------------------------------------------------------------------------------------------------------------------------------------------------
Exp1_Thr24_Mem2GB[avg] 199660.5     132767.7     135184.0     96767.6     
================================================================================================================================================================

====================================================================================================
Run Generation Time Breakdown
====================================================================================================
Config               RG Total s   Load s       Sort s       Store s     
----------------------------------------------------------------------------------------------------
Exp1_Thr24_Mem2GB[1] 694.61       0            681.01       0           
----------------------------------------------------------------------------------------------------
Exp1_Thr24_Mem2GB[avg] 694.61       0.00         681.01       0.00        
====================================================================================================
