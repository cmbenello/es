warning[E0133]: call to unsafe function `libc::posix_fadvise` is unsafe and requires unsafe block
   --> src/kvbin.rs:267:19
    |
267 |         let ret = libc::posix_fadvise(fd, 0, 0, libc::POSIX_FADV_DONTNEED);
    |                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ call to unsafe function
    |
    = note: for more information, see <https://doc.rust-lang.org/nightly/edition-guide/rust-2024/unsafe-op-in-unsafe-fn.html>
    = note: consult the function's documentation for information on how to avoid undefined behavior
note: an unsafe function restricts its caller, but its body is safe by default
   --> src/kvbin.rs:263:1
    |
263 | unsafe fn drop_cache(fd: i32) {
    | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    = note: `#[warn(unsafe_op_in_unsafe_fn)]` on by default

For more information about this error, try `rustc --explain E0133`.
warning: `es` (lib) generated 1 warning (run `cargo fix --lib -p es` to apply 1 suggestion)
    Finished `release` profile [optimized] target(s) in 0.39s
     Running `target/release/examples/lineitem_benchmark_cli -n Exp1_Thr16_Mem2GB -i /tank/local/riki/lineitem_sf500.csv --run-gen-threads 16 --merge-threads 16 --run-size-mb 128.00 --merge-fanin 2048 --warmup-runs 0 --benchmark-runs 1 --cooldown-seconds 30 --dir logs/lineitem_bench_2025-11-24_23-37-34/Exp1_Thr16_Mem2GB_tmp --ovc`
Using existing KVBin file: "./datasets/lineitem_sf500.k-8-9-13-14-15.v-0-3.kvbin"

=== BENCHMARK MODE ===
KVBin data: ./datasets/lineitem_sf500.k-8-9-13-14-15.v-0-3.kvbin, index: ./datasets/lineitem_sf500.k-8-9-13-14-15.v-0-3.kvbin.idx
Estimated data size: 199659.46 MB
Run generation threads: 16
Run generation algorithm: replacement-selection
Run size (MB): 128.00
Run generation memory (MB): 2048.0
Merge threads: 16
Merge fan-in: 2048
Merge memory (MB): 2048.0
OVC enabled: true
Temporary directory: "logs/lineitem_bench_2025-11-24_23-37-34/Exp1_Thr16_Mem2GB_tmp"
Warmup runs: 0
Runs per configuration: 1
Cooldown between runs (s): 30
Verify output: false

Running benchmark for config: Exp1_Thr16_Mem2GB
Parameters: Run Gen Threads: 16, Run Gen Algorithm: replacement-selection, Run Size: 128.00 MB, Run Gen Memory: 2048.0 MB, Merge Threads: 16, Merge Fanin: 2048, Merge Memory: 2048.0 MB, Imbalance Factor: 1.0
================================================================================
  Run 1/1: Starting sort with 16 parallel scanners for run generation
Run gen thread 9 (ReplacementSelection) 911692 ms, 50 runs generated
Run gen thread 12 (ReplacementSelection) 916488 ms, 50 runs generated
Run gen thread 8 (ReplacementSelection) 918310 ms, 50 runs generated
Run gen thread 11 (ReplacementSelection) 920102 ms, 50 runs generated
Run gen thread 6 (ReplacementSelection) 920319 ms, 50 runs generated
Run gen thread 5 (ReplacementSelection) 921765 ms, 50 runs generated
Run gen thread 2 (ReplacementSelection) 921991 ms, 50 runs generated
Run gen thread 3 (ReplacementSelection) 922120 ms, 50 runs generated
Run gen thread 15 (ReplacementSelection) 925271 ms, 50 runs generated
Run gen thread 13 (ReplacementSelection) 926912 ms, 50 runs generated
Run gen thread 7 (ReplacementSelection) 929380 ms, 50 runs generated
Run gen thread 14 (ReplacementSelection) 929452 ms, 50 runs generated
Run gen thread 1 (ReplacementSelection) 929670 ms, 50 runs generated
Run gen thread 4 (ReplacementSelection) 930321 ms, 50 runs generated
Run gen thread 10 (ReplacementSelection) 930954 ms, 50 runs generated
Run gen thread 0 (ReplacementSelection) 949671 ms, 50 runs generated
Generated 800 runs in 950616 ms
Merging 800 runs using 16 threads
Merge phase took 404665 ms | Merged 3000028242 entries across 16 runs | Thread timing: min=370941 ms, max=404634 ms | Partition sizes: imbalance=1.10x
SortStats:
  Number of runs: 800
  (R) time: 950616 ms
  (R) breakdown: load=0 ms, sort=925276 ms, store=0 ms
  (R) I/O stats: I/O Stats: Read Ops: 3194558, Read Bytes: 209358550885, Write Ops: 2088669, Write Bytes: 136882454528
  (M) time: 404665 ms
  Read amplification:
    Run generation writes: 136882454528 bytes (127.48 GB)
    Merge phase reads: 137994542592 bytes (128.52 GB)
    Read amplification factor: 1.01x
    Excess reads: 0.8% (sparse indexing overhead)
  Thread timing:
    Min thread time: 370941 ms
    Max thread time: 404634 ms
    Avg thread time: 387601 ms
    Time imbalance factor (max/avg): 1.04x
    Thread times: [381029, 391618, 404634, 386045, 383238, 388877, 378966, 395509, 370941, 393136, 385296, 393710, 385939, 401572, 390029, 371081]

1355.28s


================================================================================================================================================================
Benchmark Results Summary
================================================================================================================================================================
Config               Run Size   RG Runs    Gen Thr    Merge Thr  Total (s)  RunGen (s)   Merge (s)  Entries      Throughput       Read MB    Write MB  
                     (MB)                                                                                        (M entries/s)                         
----------------------------------------------------------------------------------------------------------------------------------------------------------------
Exp1_Thr16_Mem2GB[1] 128.0      800        16         16         1355.28      950.62     404.67     3000028242   2.21             331261.7   227308.8  
Exp1_Thr16_Mem2GB[avg] 128.0      800        16         16         1355.28      950.62     404.67     3000028242   2.21             331261.7   227308.8  
================================================================================================================================================================

================================================================================================================================================================
Merge Operations Summary (showing last 1 of 1 merge passes)
================================================================================================================================================================
Config               M1PAvg     M1PMax     M1Imbal    M1Slow       M1Fast      
----------------------------------------------------------------------------------------------------------------------------------------------------------------
Exp1_Thr16_Mem2GB[1] 187501765  206306179  1.10       404.67       404.67      
----------------------------------------------------------------------------------------------------------------------------------------------------------------
Exp1_Thr16_Mem2GB[avg] 187501765  206306179  1.10       404.67       404.67      
================================================================================================================================================================

================================================================================================================================================================
Detailed I/O Statistics
================================================================================================================================================================
Config               RG Read MB   RG Write MB  M1Read MB    M1Write MB  
----------------------------------------------------------------------------------------------------------------------------------------------------------------
Exp1_Thr16_Mem2GB[1] 199659.9     130541.3     131601.9     96767.6     
----------------------------------------------------------------------------------------------------------------------------------------------------------------
Exp1_Thr16_Mem2GB[avg] 199659.9     130541.3     131601.9     96767.6     
================================================================================================================================================================

====================================================================================================
Run Generation Time Breakdown
====================================================================================================
Config               RG Total s   Load s       Sort s       Store s     
----------------------------------------------------------------------------------------------------
Exp1_Thr16_Mem2GB[1] 950.62       0            925.276      0           
----------------------------------------------------------------------------------------------------
Exp1_Thr16_Mem2GB[avg] 950.62       0.00         925.28       0.00        
====================================================================================================
