warning[E0133]: call to unsafe function `libc::posix_fadvise` is unsafe and requires unsafe block
   --> src/kvbin.rs:267:19
    |
267 |         let ret = libc::posix_fadvise(fd, 0, 0, libc::POSIX_FADV_DONTNEED);
    |                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ call to unsafe function
    |
    = note: for more information, see <https://doc.rust-lang.org/nightly/edition-guide/rust-2024/unsafe-op-in-unsafe-fn.html>
    = note: consult the function's documentation for information on how to avoid undefined behavior
note: an unsafe function restricts its caller, but its body is safe by default
   --> src/kvbin.rs:263:1
    |
263 | unsafe fn drop_cache(fd: i32) {
    | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    = note: `#[warn(unsafe_op_in_unsafe_fn)]` on by default

For more information about this error, try `rustc --explain E0133`.
warning: `es` (lib) generated 1 warning (run `cargo fix --lib -p es` to apply 1 suggestion)
    Finished `release` profile [optimized] target(s) in 0.89s
     Running `target/release/examples/lineitem_benchmark_cli -n Exp1_Thr32_Mem2GB -i /tank/local/riki/lineitem_sf500.csv --run-gen-threads 32 --merge-threads 32 --run-size-mb 64.00 --merge-fanin 1024 --warmup-runs 0 --benchmark-runs 1 --cooldown-seconds 30 --dir logs/lineitem_bench_2025-11-24_23-37-34/Exp1_Thr32_Mem2GB_tmp --ovc`
Using existing KVBin file: "./datasets/lineitem_sf500.k-8-9-13-14-15.v-0-3.kvbin"

=== BENCHMARK MODE ===
KVBin data: ./datasets/lineitem_sf500.k-8-9-13-14-15.v-0-3.kvbin, index: ./datasets/lineitem_sf500.k-8-9-13-14-15.v-0-3.kvbin.idx
Estimated data size: 199659.46 MB
Run generation threads: 32
Run generation algorithm: replacement-selection
Run size (MB): 64.00
Run generation memory (MB): 2048.0
Merge threads: 32
Merge fan-in: 1024
Merge memory (MB): 2048.0
OVC enabled: true
Temporary directory: "logs/lineitem_bench_2025-11-24_23-37-34/Exp1_Thr32_Mem2GB_tmp"
Warmup runs: 0
Runs per configuration: 1
Cooldown between runs (s): 30
Verify output: false

Running benchmark for config: Exp1_Thr32_Mem2GB
Parameters: Run Gen Threads: 32, Run Gen Algorithm: replacement-selection, Run Size: 64.00 MB, Run Gen Memory: 2048.0 MB, Merge Threads: 32, Merge Fanin: 1024, Merge Memory: 2048.0 MB, Imbalance Factor: 1.0
================================================================================
  Run 1/1: Starting sort with 32 parallel scanners for run generation
Run gen thread 27 (ReplacementSelection) 536453 ms, 50 runs generated
Run gen thread 31 (ReplacementSelection) 538225 ms, 50 runs generated
Run gen thread 13 (ReplacementSelection) 540121 ms, 50 runs generated
Run gen thread 20 (ReplacementSelection) 541265 ms, 50 runs generated
Run gen thread 9 (ReplacementSelection) 544892 ms, 50 runs generated
Run gen thread 4 (ReplacementSelection) 545518 ms, 50 runs generated
Run gen thread 25 (ReplacementSelection) 546015 ms, 50 runs generated
Run gen thread 2 (ReplacementSelection) 546542 ms, 50 runs generated
Run gen thread 15 (ReplacementSelection) 546549 ms, 50 runs generated
Run gen thread 22 (ReplacementSelection) 546758 ms, 50 runs generated
Run gen thread 11 (ReplacementSelection) 546870 ms, 50 runs generated
Run gen thread 7 (ReplacementSelection) 547797 ms, 50 runs generated
Run gen thread 30 (ReplacementSelection) 548093 ms, 50 runs generated
Run gen thread 17 (ReplacementSelection) 548482 ms, 50 runs generated
Run gen thread 10 (ReplacementSelection) 550010 ms, 50 runs generated
Run gen thread 6 (ReplacementSelection) 550484 ms, 50 runs generated
Run gen thread 12 (ReplacementSelection) 550545 ms, 50 runs generated
Run gen thread 26 (ReplacementSelection) 550629 ms, 50 runs generated
Run gen thread 1 (ReplacementSelection) 552741 ms, 50 runs generated
Run gen thread 21 (ReplacementSelection) 552744 ms, 50 runs generated
Run gen thread 0 (ReplacementSelection) 552976 ms, 50 runs generated
Run gen thread 29 (ReplacementSelection) 553445 ms, 50 runs generated
Run gen thread 8 (ReplacementSelection) 553566 ms, 50 runs generated
Run gen thread 23 (ReplacementSelection) 553847 ms, 50 runs generated
Run gen thread 14 (ReplacementSelection) 553892 ms, 50 runs generated
Run gen thread 24 (ReplacementSelection) 554105 ms, 50 runs generated
Run gen thread 16 (ReplacementSelection) 554287 ms, 50 runs generated
Run gen thread 19 (ReplacementSelection) 556040 ms, 50 runs generated
Run gen thread 3 (ReplacementSelection) 557185 ms, 50 runs generated
Run gen thread 28 (ReplacementSelection) 557322 ms, 50 runs generated
Run gen thread 18 (ReplacementSelection) 557380 ms, 50 runs generated
Run gen thread 5 (ReplacementSelection) 557804 ms, 50 runs generated
Generated 1600 runs in 558967 ms
Multi-level merge: 2047 runs (including 447 dummies), F=1024, expected 2 merge operations
Merging 1024 runs using 32 threads
Merge phase took 96213 ms | Merged 1031935431 entries across 32 runs | Thread timing: min=71409 ms, max=96209 ms | Partition sizes: imbalance=1.28x
Merge 1/2: merging 1024 shortest runs (1031935431 total entries)
Merging 1024 runs using 32 threads
Merge phase took 268958 ms | Merged 3000028242 entries across 32 runs | Thread timing: min=206266 ms, max=268955 ms | Partition sizes: imbalance=1.28x
Merge 2/2: merging 1024 shortest runs (3000028242 total entries)
SortStats:
  Number of runs: 1600
  (R) time: 558967 ms
  (R) breakdown: load=0 ms, sort=549768 ms, store=0 ms
  (R) I/O stats: I/O Stats: Read Ops: 3194562, Read Bytes: 209358781285, Write Ops: 2149945, Write Bytes: 140897681920
  (M) time: 365171 ms
  Read amplification:
    Run generation writes: 140897681920 bytes (131.22 GB)
    Merge phase reads: 182457347072 bytes (169.93 GB)
    Read amplification factor: 1.29x
    Excess reads: 29.5% (sparse indexing overhead)
  Thread timing (merge pass 1):
    Min thread time: 71409 ms
    Max thread time: 96209 ms
    Avg thread time: 87451 ms
    Time imbalance factor (max/avg): 1.10x
    Thread times: [86439, 90293, 88902, 90708, 89154, 87374, 88999, 92720, 86825, 90467, 77510, 96209, 71409, 87574, 84350, 90273, 90880, 86019, 88830, 88257, 85296, 93260, 80275, 88039, 88503, 76987, 92214, 87757, 90361, 94663, 87071, 80819]
  Thread timing (merge pass 2):
    Min thread time: 206266 ms
    Max thread time: 268955 ms
    Avg thread time: 241775 ms
    Time imbalance factor (max/avg): 1.11x
    Thread times: [238943, 253604, 244980, 250001, 251147, 243956, 247906, 256351, 226994, 250965, 218469, 268955, 206266, 247501, 243542, 241348, 251575, 235154, 248378, 248661, 234183, 260425, 214417, 247990, 242319, 207351, 254772, 232205, 248963, 261295, 235542, 222638]
  Multi-level merge details:
    Total merge passes: 2
    Merge pass 1:
      Time: 96213 ms
      Output runs: 32
      I/O: read=47787.68 MiB, write=35335.75 MiB
      Partitions: 32, imbalance: 1.28x
    Merge pass 2:
      Time: 268958 ms
      Output runs: 32
      I/O: read=126217.21 MiB, write=96767.57 MiB
      Partitions: 32, imbalance: 1.28x

924.14s


================================================================================================================================================================
Benchmark Results Summary
================================================================================================================================================================
Config               Run Size   RG Runs    Gen Thr    Merge Thr  Total (s)  RunGen (s)   Merge (s)  Entries      Throughput       Read MB    Write MB  
                     (MB)                                                                                        (M entries/s)                         
----------------------------------------------------------------------------------------------------------------------------------------------------------------
Exp1_Thr32_Mem2GB[1] 64.0       1600       32         32         924.14       558.97     365.17     3000028242   3.25             373665.0   266473.8  
Exp1_Thr32_Mem2GB[avg] 64.0       1600       32         32         924.14       558.97     365.17     3000028242   3.25             373665.0   266473.8  
================================================================================================================================================================

================================================================================================================================================================
Merge Operations Summary (showing last 2 of 2 merge passes)
================================================================================================================================================================
Config               M1PAvg     M1PMax     M1Imbal    M1Slow       M1Fast       M2PAvg     M2PMax     M2Imbal    M2Slow       M2Fast      
----------------------------------------------------------------------------------------------------------------------------------------------------------------
Exp1_Thr32_Mem2GB[1] 32247982   41177962   1.28       96.21        96.21        93750882   119703022  1.28       268.96       268.96      
----------------------------------------------------------------------------------------------------------------------------------------------------------------
Exp1_Thr32_Mem2GB[avg] 32247982   41177962   1.28       96.21        96.21        93750882   119703022  1.28       268.96       268.96      
================================================================================================================================================================

================================================================================================================================================================
Detailed I/O Statistics
================================================================================================================================================================
Config               RG Read MB   RG Write MB  M1Read MB    M1Write MB   M2Read MB    M2Write MB  
----------------------------------------------------------------------------------------------------------------------------------------------------------------
Exp1_Thr32_Mem2GB[1] 199660.1     134370.5     47787.7      35335.8      126217.2     96767.6     
----------------------------------------------------------------------------------------------------------------------------------------------------------------
Exp1_Thr32_Mem2GB[avg] 199660.1     134370.5     47787.7      35335.8      126217.2     96767.6     
================================================================================================================================================================

====================================================================================================
Run Generation Time Breakdown
====================================================================================================
Config               RG Total s   Load s       Sort s       Store s     
----------------------------------------------------------------------------------------------------
Exp1_Thr32_Mem2GB[1] 558.97       0            549.768      0           
----------------------------------------------------------------------------------------------------
Exp1_Thr32_Mem2GB[avg] 558.97       0.00         549.77       0.00        
====================================================================================================
