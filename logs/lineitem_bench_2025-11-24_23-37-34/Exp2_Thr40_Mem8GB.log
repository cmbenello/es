warning[E0133]: call to unsafe function `libc::posix_fadvise` is unsafe and requires unsafe block
   --> src/kvbin.rs:267:19
    |
267 |         let ret = libc::posix_fadvise(fd, 0, 0, libc::POSIX_FADV_DONTNEED);
    |                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ call to unsafe function
    |
    = note: for more information, see <https://doc.rust-lang.org/nightly/edition-guide/rust-2024/unsafe-op-in-unsafe-fn.html>
    = note: consult the function's documentation for information on how to avoid undefined behavior
note: an unsafe function restricts its caller, but its body is safe by default
   --> src/kvbin.rs:263:1
    |
263 | unsafe fn drop_cache(fd: i32) {
    | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    = note: `#[warn(unsafe_op_in_unsafe_fn)]` on by default

For more information about this error, try `rustc --explain E0133`.
warning: `es` (lib) generated 1 warning (run `cargo fix --lib -p es` to apply 1 suggestion)
    Finished `release` profile [optimized] target(s) in 1.53s
     Running `target/release/examples/lineitem_benchmark_cli -n Exp2_Thr40_Mem8GB -i /tank/local/riki/lineitem_sf500.csv --run-gen-threads 40 --merge-threads 40 --run-size-mb 204.80 --merge-fanin 3276 --warmup-runs 0 --benchmark-runs 1 --cooldown-seconds 30 --dir logs/lineitem_bench_2025-11-24_23-37-34/Exp2_Thr40_Mem8GB_tmp --ovc`
Using existing KVBin file: "./datasets/lineitem_sf500.k-8-9-13-14-15.v-0-3.kvbin"

=== BENCHMARK MODE ===
KVBin data: ./datasets/lineitem_sf500.k-8-9-13-14-15.v-0-3.kvbin, index: ./datasets/lineitem_sf500.k-8-9-13-14-15.v-0-3.kvbin.idx
Estimated data size: 199659.46 MB
Run generation threads: 40
Run generation algorithm: replacement-selection
Run size (MB): 204.80
Run generation memory (MB): 8192.0
Merge threads: 40
Merge fan-in: 3276
Merge memory (MB): 8190.0
OVC enabled: true
Temporary directory: "logs/lineitem_bench_2025-11-24_23-37-34/Exp2_Thr40_Mem8GB_tmp"
Warmup runs: 0
Runs per configuration: 1
Cooldown between runs (s): 30
Verify output: false

Running benchmark for config: Exp2_Thr40_Mem8GB
Parameters: Run Gen Threads: 40, Run Gen Algorithm: replacement-selection, Run Size: 204.80 MB, Run Gen Memory: 8192.0 MB, Merge Threads: 40, Merge Fanin: 3276, Merge Memory: 8190.0 MB, Imbalance Factor: 1.0
================================================================================
  Run 1/1: Starting sort with 40 parallel scanners for run generation
Run gen thread 3 (ReplacementSelection) 615573 ms, 13 runs generated
Run gen thread 0 (ReplacementSelection) 618306 ms, 13 runs generated
Run gen thread 9 (ReplacementSelection) 619718 ms, 13 runs generated
Run gen thread 8 (ReplacementSelection) 620077 ms, 13 runs generated
Run gen thread 11 (ReplacementSelection) 620488 ms, 13 runs generated
Run gen thread 23 (ReplacementSelection) 621630 ms, 13 runs generated
Run gen thread 27 (ReplacementSelection) 624807 ms, 13 runs generated
Run gen thread 5 (ReplacementSelection) 626228 ms, 13 runs generated
Run gen thread 38 (ReplacementSelection) 626716 ms, 13 runs generated
Run gen thread 30 (ReplacementSelection) 627186 ms, 13 runs generated
Run gen thread 24 (ReplacementSelection) 630327 ms, 13 runs generated
Run gen thread 2 (ReplacementSelection) 630348 ms, 13 runs generated
Run gen thread 16 (ReplacementSelection) 630487 ms, 13 runs generated
Run gen thread 25 (ReplacementSelection) 631206 ms, 13 runs generated
Run gen thread 37 (ReplacementSelection) 631418 ms, 13 runs generated
Run gen thread 22 (ReplacementSelection) 637808 ms, 13 runs generated
Run gen thread 39 (ReplacementSelection) 638719 ms, 13 runs generated
Run gen thread 32 (ReplacementSelection) 639579 ms, 13 runs generated
Run gen thread 26 (ReplacementSelection) 639832 ms, 13 runs generated
Run gen thread 6 (ReplacementSelection) 640792 ms, 13 runs generated
Run gen thread 31 (ReplacementSelection) 642276 ms, 13 runs generated
Run gen thread 17 (ReplacementSelection) 643128 ms, 13 runs generated
Run gen thread 12 (ReplacementSelection) 643528 ms, 13 runs generated
Run gen thread 18 (ReplacementSelection) 646078 ms, 13 runs generated
Run gen thread 19 (ReplacementSelection) 647133 ms, 13 runs generated
Run gen thread 21 (ReplacementSelection) 647484 ms, 13 runs generated
Run gen thread 29 (ReplacementSelection) 648077 ms, 13 runs generated
Run gen thread 33 (ReplacementSelection) 648388 ms, 13 runs generated
Run gen thread 7 (ReplacementSelection) 648575 ms, 13 runs generated
Run gen thread 35 (ReplacementSelection) 648608 ms, 13 runs generated
Run gen thread 13 (ReplacementSelection) 648712 ms, 13 runs generated
Run gen thread 34 (ReplacementSelection) 648828 ms, 13 runs generated
Run gen thread 10 (ReplacementSelection) 649289 ms, 13 runs generated
Run gen thread 36 (ReplacementSelection) 650623 ms, 13 runs generated
Run gen thread 15 (ReplacementSelection) 650880 ms, 13 runs generated
Run gen thread 28 (ReplacementSelection) 650952 ms, 13 runs generated
Run gen thread 20 (ReplacementSelection) 651465 ms, 13 runs generated
Run gen thread 14 (ReplacementSelection) 651506 ms, 13 runs generated
Run gen thread 1 (ReplacementSelection) 651991 ms, 13 runs generated
Run gen thread 4 (ReplacementSelection) 663584 ms, 13 runs generated
Generated 520 runs in 664685 ms
Merging 520 runs using 40 threads
Merge phase took 273277 ms | Merged 3000028242 entries across 40 runs | Thread timing: min=233071 ms, max=273183 ms | Partition sizes: imbalance=1.20x
SortStats:
  Number of runs: 520
  (R) time: 664685 ms
  (R) breakdown: load=0 ms, sort=638808 ms, store=0 ms
  (R) I/O stats: I/O Stats: Read Ops: 3194568, Read Bytes: 209359202661, Write Ops: 2050156, Write Bytes: 134357422592
  (M) time: 273277 ms
  Read amplification:
    Run generation writes: 134357422592 bytes (125.13 GB)
    Merge phase reads: 136165305344 bytes (126.81 GB)
    Read amplification factor: 1.01x
    Excess reads: 1.3% (sparse indexing overhead)
  Thread timing:
    Min thread time: 233071 ms
    Max thread time: 273183 ms
    Avg thread time: 254505 ms
    Time imbalance factor (max/avg): 1.07x

937.96s


================================================================================================================================================================
Benchmark Results Summary
================================================================================================================================================================
Config               Run Size   RG Runs    Gen Thr    Merge Thr  Total (s)  RunGen (s)   Merge (s)  Entries      Throughput       Read MB    Write MB  
                     (MB)                                                                                        (M entries/s)                         
----------------------------------------------------------------------------------------------------------------------------------------------------------------
Exp2_Thr40_Mem8GB[1] 204.8      520        40         40         937.96       664.68     273.28     3000028242   3.20             329517.8   224900.8  
Exp2_Thr40_Mem8GB[avg] 204.8      520        40         40         937.96       664.68     273.28     3000028242   3.20             329517.8   224900.8  
================================================================================================================================================================

================================================================================================================================================================
Merge Operations Summary (showing last 1 of 1 merge passes)
================================================================================================================================================================
Config               M1PAvg     M1PMax     M1Imbal    M1Slow       M1Fast      
----------------------------------------------------------------------------------------------------------------------------------------------------------------
Exp2_Thr40_Mem8GB[1] 75000706   90344786   1.20       273.28       273.28      
----------------------------------------------------------------------------------------------------------------------------------------------------------------
Exp2_Thr40_Mem8GB[avg] 75000706   90344786   1.20       273.28       273.28      
================================================================================================================================================================

================================================================================================================================================================
Detailed I/O Statistics
================================================================================================================================================================
Config               RG Read MB   RG Write MB  M1Read MB    M1Write MB  
----------------------------------------------------------------------------------------------------------------------------------------------------------------
Exp2_Thr40_Mem8GB[1] 199660.5     128133.2     129857.4     96767.6     
----------------------------------------------------------------------------------------------------------------------------------------------------------------
Exp2_Thr40_Mem8GB[avg] 199660.5     128133.2     129857.4     96767.6     
================================================================================================================================================================

====================================================================================================
Run Generation Time Breakdown
====================================================================================================
Config               RG Total s   Load s       Sort s       Store s     
----------------------------------------------------------------------------------------------------
Exp2_Thr40_Mem8GB[1] 664.68       0            638.808      0           
----------------------------------------------------------------------------------------------------
Exp2_Thr40_Mem8GB[avg] 664.68       0.00         638.81       0.00        
====================================================================================================
