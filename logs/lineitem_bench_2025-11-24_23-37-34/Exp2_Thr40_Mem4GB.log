warning[E0133]: call to unsafe function `libc::posix_fadvise` is unsafe and requires unsafe block
   --> src/kvbin.rs:267:19
    |
267 |         let ret = libc::posix_fadvise(fd, 0, 0, libc::POSIX_FADV_DONTNEED);
    |                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ call to unsafe function
    |
    = note: for more information, see <https://doc.rust-lang.org/nightly/edition-guide/rust-2024/unsafe-op-in-unsafe-fn.html>
    = note: consult the function's documentation for information on how to avoid undefined behavior
note: an unsafe function restricts its caller, but its body is safe by default
   --> src/kvbin.rs:263:1
    |
263 | unsafe fn drop_cache(fd: i32) {
    | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    = note: `#[warn(unsafe_op_in_unsafe_fn)]` on by default

For more information about this error, try `rustc --explain E0133`.
warning: `es` (lib) generated 1 warning (run `cargo fix --lib -p es` to apply 1 suggestion)
    Finished `release` profile [optimized] target(s) in 0.72s
     Running `target/release/examples/lineitem_benchmark_cli -n Exp2_Thr40_Mem4GB -i /tank/local/riki/lineitem_sf500.csv --run-gen-threads 40 --merge-threads 40 --run-size-mb 102.40 --merge-fanin 1638 --warmup-runs 0 --benchmark-runs 1 --cooldown-seconds 30 --dir logs/lineitem_bench_2025-11-24_23-37-34/Exp2_Thr40_Mem4GB_tmp --ovc`
Using existing KVBin file: "./datasets/lineitem_sf500.k-8-9-13-14-15.v-0-3.kvbin"

=== BENCHMARK MODE ===
KVBin data: ./datasets/lineitem_sf500.k-8-9-13-14-15.v-0-3.kvbin, index: ./datasets/lineitem_sf500.k-8-9-13-14-15.v-0-3.kvbin.idx
Estimated data size: 199659.46 MB
Run generation threads: 40
Run generation algorithm: replacement-selection
Run size (MB): 102.40
Run generation memory (MB): 4096.0
Merge threads: 40
Merge fan-in: 1638
Merge memory (MB): 4095.0
OVC enabled: true
Temporary directory: "logs/lineitem_bench_2025-11-24_23-37-34/Exp2_Thr40_Mem4GB_tmp"
Warmup runs: 0
Runs per configuration: 1
Cooldown between runs (s): 30
Verify output: false

Running benchmark for config: Exp2_Thr40_Mem4GB
Parameters: Run Gen Threads: 40, Run Gen Algorithm: replacement-selection, Run Size: 102.40 MB, Run Gen Memory: 4096.0 MB, Merge Threads: 40, Merge Fanin: 1638, Merge Memory: 4095.0 MB, Imbalance Factor: 1.0
================================================================================
  Run 1/1: Starting sort with 40 parallel scanners for run generation
Run gen thread 28 (ReplacementSelection) 470889 ms, 26 runs generated
Run gen thread 33 (ReplacementSelection) 470921 ms, 26 runs generated
Run gen thread 31 (ReplacementSelection) 471030 ms, 26 runs generated
Run gen thread 39 (ReplacementSelection) 471175 ms, 25 runs generated
Run gen thread 32 (ReplacementSelection) 472149 ms, 26 runs generated
Run gen thread 12 (ReplacementSelection) 472181 ms, 26 runs generated
Run gen thread 2 (ReplacementSelection) 472788 ms, 26 runs generated
Run gen thread 23 (ReplacementSelection) 472883 ms, 26 runs generated
Run gen thread 8 (ReplacementSelection) 473753 ms, 26 runs generated
Run gen thread 21 (ReplacementSelection) 474458 ms, 26 runs generated
Run gen thread 19 (ReplacementSelection) 475612 ms, 26 runs generated
Run gen thread 6 (ReplacementSelection) 475891 ms, 26 runs generated
Run gen thread 11 (ReplacementSelection) 476258 ms, 26 runs generated
Run gen thread 9 (ReplacementSelection) 476404 ms, 26 runs generated
Run gen thread 22 (ReplacementSelection) 476700 ms, 26 runs generated
Run gen thread 34 (ReplacementSelection) 476795 ms, 26 runs generated
Run gen thread 29 (ReplacementSelection) 476818 ms, 26 runs generated
Run gen thread 17 (ReplacementSelection) 478349 ms, 26 runs generated
Run gen thread 5 (ReplacementSelection) 478446 ms, 26 runs generated
Run gen thread 25 (ReplacementSelection) 479151 ms, 25 runs generated
Run gen thread 37 (ReplacementSelection) 481140 ms, 26 runs generated
Run gen thread 24 (ReplacementSelection) 481787 ms, 26 runs generated
Run gen thread 10 (ReplacementSelection) 481843 ms, 26 runs generated
Run gen thread 16 (ReplacementSelection) 482113 ms, 26 runs generated
Run gen thread 7 (ReplacementSelection) 483096 ms, 26 runs generated
Run gen thread 30 (ReplacementSelection) 483203 ms, 26 runs generated
Run gen thread 26 (ReplacementSelection) 484100 ms, 26 runs generated
Run gen thread 18 (ReplacementSelection) 484184 ms, 26 runs generated
Run gen thread 1 (ReplacementSelection) 484311 ms, 26 runs generated
Run gen thread 27 (ReplacementSelection) 485056 ms, 26 runs generated
Run gen thread 13 (ReplacementSelection) 485623 ms, 26 runs generated
Run gen thread 4 (ReplacementSelection) 486232 ms, 26 runs generated
Run gen thread 35 (ReplacementSelection) 486893 ms, 26 runs generated
Run gen thread 38 (ReplacementSelection) 487102 ms, 26 runs generated
Run gen thread 0 (ReplacementSelection) 487848 ms, 26 runs generated
Run gen thread 3 (ReplacementSelection) 488106 ms, 26 runs generated
Run gen thread 14 (ReplacementSelection) 491147 ms, 26 runs generated
Run gen thread 20 (ReplacementSelection) 491867 ms, 26 runs generated
Run gen thread 36 (ReplacementSelection) 493077 ms, 26 runs generated
Run gen thread 15 (ReplacementSelection) 498419 ms, 26 runs generated
Generated 1038 runs in 499806 ms
Merging 1038 runs using 40 threads
Merge phase took 237480 ms | Merged 3000028242 entries across 40 runs | Thread timing: min=149941 ms, max=237476 ms | Partition sizes: imbalance=1.26x
SortStats:
  Number of runs: 1038
  (R) time: 499806 ms
  (R) breakdown: load=0 ms, sort=480494 ms, store=0 ms
  (R) I/O stats: I/O Stats: Read Ops: 3194568, Read Bytes: 209359202661, Write Ops: 2108881, Write Bytes: 138206327296
  (M) time: 237480 ms
  Read amplification:
    Run generation writes: 138206327296 bytes (128.71 GB)
    Merge phase reads: 141834716672 bytes (132.09 GB)
    Read amplification factor: 1.03x
    Excess reads: 2.6% (sparse indexing overhead)
  Thread timing:
    Min thread time: 149941 ms
    Max thread time: 237476 ms
    Avg thread time: 208057 ms
    Time imbalance factor (max/avg): 1.14x

737.29s


================================================================================================================================================================
Benchmark Results Summary
================================================================================================================================================================
Config               Run Size   RG Runs    Gen Thr    Merge Thr  Total (s)  RunGen (s)   Merge (s)  Entries      Throughput       Read MB    Write MB  
                     (MB)                                                                                        (M entries/s)                         
----------------------------------------------------------------------------------------------------------------------------------------------------------------
Exp2_Thr40_Mem4GB[1] 102.4      1038       40         40         737.29       499.81     237.48     3000028242   4.07             334924.6   228571.4  
Exp2_Thr40_Mem4GB[avg] 102.4      1038       40         40         737.29       499.81     237.48     3000028242   4.07             334924.6   228571.4  
================================================================================================================================================================

================================================================================================================================================================
Merge Operations Summary (showing last 1 of 1 merge passes)
================================================================================================================================================================
Config               M1PAvg     M1PMax     M1Imbal    M1Slow       M1Fast      
----------------------------------------------------------------------------------------------------------------------------------------------------------------
Exp2_Thr40_Mem4GB[1] 75000706   94723265   1.26       237.48       237.48      
----------------------------------------------------------------------------------------------------------------------------------------------------------------
Exp2_Thr40_Mem4GB[avg] 75000706   94723265   1.26       237.48       237.48      
================================================================================================================================================================

================================================================================================================================================================
Detailed I/O Statistics
================================================================================================================================================================
Config               RG Read MB   RG Write MB  M1Read MB    M1Write MB  
----------------------------------------------------------------------------------------------------------------------------------------------------------------
Exp2_Thr40_Mem4GB[1] 199660.5     131803.8     135264.1     96767.6     
----------------------------------------------------------------------------------------------------------------------------------------------------------------
Exp2_Thr40_Mem4GB[avg] 199660.5     131803.8     135264.1     96767.6     
================================================================================================================================================================

====================================================================================================
Run Generation Time Breakdown
====================================================================================================
Config               RG Total s   Load s       Sort s       Store s     
----------------------------------------------------------------------------------------------------
Exp2_Thr40_Mem4GB[1] 499.81       0            480.494      0           
----------------------------------------------------------------------------------------------------
Exp2_Thr40_Mem4GB[avg] 499.81       0.00         480.49       0.00        
====================================================================================================
